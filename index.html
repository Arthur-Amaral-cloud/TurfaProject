<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>FlashHorses</title>
</head>

<body>
    <main class="main-screen">
        <section id="boxWelcome">
            <div class="title-welcome">Seja Bem-vindo a Turfa</div>
            <div class="box-button-welcome">
                <button onclick="irparacadastro()">Vamos correr!</button>
            </div>
        </section>
        <section id="boxCadastro">
            <span>Coloque a quantidade cavalos na corrida</span><input type="number" maxlength="1" id="ipt_qtdcavalos">
            <span>Coloque a quantidade de voltas que a corrida terá</span> <input type="number" maxlength="2"
                id="ipt_voltas">
            <button id="cadCavalos" onclick="irparacadastrocavalo()">Cadastrar Cavalos</button>
        </section>
        <section id="boxCadastroNomes">
            <span>Coloque o nome do cavalo participante</span> <input type="text" id="ipt_cavalo_participante">
            <button id="jogar" onclick="cad_nome()">Cadastrar nome</button>
            <div id="div_cavalos_cadastrados"></div>
        </section>
        <div id="tabelaResultados"></div>
        <div id="resposta"></div>
    </main>
</body>

</html>
<script>
    var nome_cavalo = []
    var tempo_acumulado = [];
    var voltas = 0;
    var qtd_cavalos = 0;
    var primeiro_lugar = 0;
    var segundo_lugar = 0;
    var terceiro_lugar = 0;

    function irparacadastro() {
        boxWelcome.style.display = "none";
        boxCadastro.style.display = "flex";
    }

    function irparacadastrocavalo() {
        if (ipt_qtdcavalos.value < 2 || ipt_qtdcavalos.value > 6 || ipt_voltas.value < 5 || ipt_voltas.value > 10) {
            if ((ipt_qtdcavalos.value < 2 || ipt_qtdcavalos.value > 6) && (ipt_voltas.value < 5 || ipt_voltas.value > 10)) {
                alert(`O número de cavalos deve estar entre 2 e 6. E o número de voltas entre 5 e 10`);
            } else if(ipt_qtdcavalos.value < 2 || ipt_qtdcavalos.value > 6) {
                alert(`O número de cavalos deve estar entre 2 e 6.`);
            } else {
                alert(`O número de voltas deve estar entre 5 e 10`);
            }
            
        } else {
            if ((ipt_qtdcavalos.value > 0 && ipt_qtdcavalos.value != null) || (ipt_voltas.value > 0 && ipt_voltas.value != null)) {
                voltas = ipt_voltas.value
                qtd_cavalos = ipt_qtdcavalos.value

                ipt_qtdcavalos.value = ``;
                ipt_voltas.value = ``;

                boxWelcome.style.display = "none";
                boxCadastro.style.display = "none";
                boxCadastroNomes.style.display = "flex";

            } else {
                alert('Insira valores nos campos');
            }
        }
    }

    function cad_nome() {
        var nomeCavalo = ipt_cavalo_participante.value;

        if (qtd_cavalos > 0) {
            if (nomeCavalo != "") {
                nome_cavalo.push(nomeCavalo);

                qtd_cavalos--;
                ipt_cavalo_participante.value = ``;

                if (qtd_cavalos == 0) {
                    ipt_cavalo_participante.style.display = 'none';
                    jogar.innerHTML = `Iniciar Corrida`;
                }
                div_cavalos_cadastrados.innerHTML = ``
                for (let i = 0; i < nome_cavalo.length; i++) {
                    div_cavalos_cadastrados.innerHTML += `<div id="${i}">${i + 1} - ${nome_cavalo[i]} <button onclick="close${i}()">X</button></div>`
                }
            }
            else {
                alert('Insira o nome de um cavalo')
            }
        }
        else {
            iniciarCorrida();

            boxCadastroNomes.style.display = "none";

        }
    }
    function close0() {
        if (qtd_cavalos == 0) {
            ipt_cavalo_participante.style.display = 'flex';
            jogar.innerHTML = `Cadastrar nome`;
        }
        qtd_cavalos++;
        nome_cavalo.splice(0, 1);
        div_cavalos_cadastrados.innerHTML = ``
        for (let i = 0; i < nome_cavalo.length; i++) {
            div_cavalos_cadastrados.innerHTML += `<div id="${i}">${i + 1} - ${nome_cavalo[i]} <button onclick="close${i}()">X</button></div>`
        }
    }
    function close1() {
        if (qtd_cavalos == 0) {
            ipt_cavalo_participante.style.display = 'flex';
            jogar.innerHTML = `Cadastrar nome`;
        }
        qtd_cavalos++;
        nome_cavalo.splice(1, 1);
        div_cavalos_cadastrados.innerHTML = ``
        for (let i = 0; i < nome_cavalo.length; i++) {
            div_cavalos_cadastrados.innerHTML += `<div id="${i}">${i + 1} - ${nome_cavalo[i]} <button onclick="close${i}()">X</button></div>`
        }
    }
    function close2() {
        if (qtd_cavalos == 0) {
            ipt_cavalo_participante.style.display = 'flex';
            jogar.innerHTML = `Cadastrar nome`;
        }
        qtd_cavalos++;
        nome_cavalo.splice(2, 1);
        div_cavalos_cadastrados.innerHTML = ``
        for (let i = 0; i < nome_cavalo.length; i++) {
            div_cavalos_cadastrados.innerHTML += `<div id="${i}">${i + 1} - ${nome_cavalo[i]} <button onclick="close${i}()">X</button></div>`
        }
    }
    function close3() {
        if (qtd_cavalos == 0) {
            ipt_cavalo_participante.style.display = 'flex';
            jogar.innerHTML = `Cadastrar nome`;
        }
        qtd_cavalos++;
        nome_cavalo.splice(3, 1);
        div_cavalos_cadastrados.innerHTML = ``
        for (let i = 0; i < nome_cavalo.length; i++) {
            div_cavalos_cadastrados.innerHTML += `<div id="${i}">${i + 1} - ${nome_cavalo[i]} <button onclick="close${i}()">X</button></div>`
        }
    }
    function close4() {
        if (qtd_cavalos == 0) {
            ipt_cavalo_participante.style.display = 'flex';
            jogar.innerHTML = `Cadastrar nome`;
        }
        qtd_cavalos++;
        nome_cavalo.splice(4, 1);
        div_cavalos_cadastrados.innerHTML = ``
        for (let i = 0; i < nome_cavalo.length; i++) {
            div_cavalos_cadastrados.innerHTML += `<div id="${i}">${i + 1} - ${nome_cavalo[i]} <button onclick="close${i}()">X</button></div>`
        }
    }
    function close5() {
        if (qtd_cavalos == 0) {
            ipt_cavalo_participante.style.display = 'flex';
            jogar.innerHTML = `Cadastrar nome`;
        }
        qtd_cavalos++;
        nome_cavalo.splice(5, 1);
        div_cavalos_cadastrados.innerHTML = ``
        for (let i = 0; i < nome_cavalo.length; i++) {
            div_cavalos_cadastrados.innerHTML += `<div id="${i}">${i + 1} - ${nome_cavalo[i]} <button onclick="close${i}()">X</button></div>`
        }
    }

    function iniciarCorrida() {
        var tabelaHTML = '<table><tr><th>Cavalo</th>';

        for (var v = 1; v <= voltas; v++) {
            tabelaHTML += `<th>Volta ${v}</th>`;
            if (v == voltas) {
                tabelaHTML += `<th>Tempo Acumulado</th>`;
            }
        }
        tabelaHTML += '</tr>';

        for (var i = 0; i < nome_cavalo.length; i++) {
            tabelaHTML += `<tr id="cavalo-${i}"><td>${nome_cavalo[i]}</td>`;

            var tempo_A = 0;
            for (var v = 1; v <= voltas; v++) {
                var tempo = Number((Math.random() * 2 + 7).toFixed(1));
                tempo_A += Number(tempo);
                tempo_A = Number(tempo_A.toFixed(1));
                tabelaHTML += `<td>${tempo}</td>`;
            }
            tabelaHTML += `<td>${tempo_A}</td>`;
            tempo_acumulado.push(tempo_A);
            tabelaHTML += '</tr>';
        }

        tabelaHTML += '</table>';
        document.getElementById('tabelaResultados').innerHTML = tabelaHTML;

        for (let i = 0; i < tempo_acumulado.length; i++) {
            if (tempo_acumulado[i] < tempo_acumulado[primeiro_lugar]) {
                terceiro_lugar = segundo_lugar;
                segundo_lugar = primeiro_lugar;
                primeiro_lugar = i;
            }
            else if (tempo_acumulado[i] < tempo_acumulado[segundo_lugar] || primeiro_lugar == segundo_lugar) {
                terceiro_lugar = segundo_lugar;
                segundo_lugar = i;

            }
            else if (tempo_acumulado[i] < tempo_acumulado[terceiro_lugar] || primeiro_lugar == terceiro_lugar || terceiro_lugar == segundo_lugar) {
                terceiro_lugar = i;
            }

        }

        if (tempo_acumulado.length >= 3) {
            resposta.innerHTML += `<br><br>Primeiro Lugar: ${nome_cavalo[primeiro_lugar]} Tempo: ${tempo_acumulado[primeiro_lugar]}m<br>Segundo Lugar: ${nome_cavalo[segundo_lugar]} Tempo: ${tempo_acumulado[segundo_lugar]}m<br>Terceiro Lugar: ${nome_cavalo[terceiro_lugar]} Tempo: ${tempo_acumulado[terceiro_lugar]}m`;
        } else {
            resposta.innerHTML += `<br><br>Primeiro Lugar: ${nome_cavalo[primeiro_lugar]} Tempo: ${tempo_acumulado[primeiro_lugar]}m<br>Segundo Lugar: ${nome_cavalo[segundo_lugar]} Tempo: ${tempo_acumulado[segundo_lugar]}m`;
        }

        resposta.innerHTML += `<br><br>Critério de Desempate: Ordem de Inscrição`;

    }

    function criarTabelaResultados() {
        var tabelaHTML = '<table><tr><th>Cavalo</th>';

        for (var v = 1; v <= voltas; v++) {
            tabelaHTML += `<th>Volta ${v}</th>`;
        }
        tabelaHTML += '</tr>';

        for (var i = 0; i < nome_cavalo.length; i++) {
            tabelaHTML += `<tr id="cavalo-${i}"><td>${nome_cavalo[i]}</td>`;

            for (var v = 1; v <= voltas; v++) {
                tabelaHTML += '<td>-</td>';
            }
            tabelaHTML += '</tr>';
        }

        tabelaHTML += '</table>';
        document.getElementById('tabelaResultados').innerHTML = tabelaHTML;
    }

    /*        for (var i = 1; i <= voltas; i++) {
            resposta.innerHTML += `<br>Volta ${i} <br>`;
            if (i == 1) {
                for (var index = 0; index < nome_cavalo.length; index++) {
                    var tempo = Number((Math.random() * 2 + 7).toFixed(1));
                    tempo_acumulado.push(tempo);
                    resposta.innerHTML += `Cavalo:${nome_cavalo[index]} - Tempo Acumulado:${tempo_acumulado[index]}m - Tempo da volta:${tempo}m - `
                }
            } else {
                for (var index = 0; index < nome_cavalo.length; index++) {
                    var tempo = Number((Math.random() * 2 + 7).toFixed(1));
                    tempo_acumulado[index] += tempo;
                    tempo_acumulado[index] = Number(tempo_acumulado[index].toFixed(1));
                    resposta.innerHTML += `Cavalo:${nome_cavalo[index]} - Tempo Acumulado:${tempo_acumulado[index]}m - Tempo da volta:${tempo}m - `
                }
            }
        }*/
</script>